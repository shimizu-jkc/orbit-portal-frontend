<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>監視とエスカレーション | OrBIT Portal</title>
    <meta name="description" content="OrBITは、クラウドを利用した開発や運用を支援するために作られた「クラウド基盤」です。">
    <meta name="generator" content="VuePress 1.3.0">
    
    
    <link rel="preload" href="/assets/css/0.styles.1b1033a6.css" as="style"><link rel="preload" href="/assets/js/app.007b4e4b.js" as="script"><link rel="preload" href="/assets/js/2.6effe7eb.js" as="script"><link rel="preload" href="/assets/js/22.a6fb60dc.js" as="script"><link rel="preload" href="/assets/js/6.db5e8172.js" as="script"><link rel="prefetch" href="/assets/js/10.a36388c7.js"><link rel="prefetch" href="/assets/js/11.4ec61767.js"><link rel="prefetch" href="/assets/js/12.b8b4cc09.js"><link rel="prefetch" href="/assets/js/13.1ed26d5d.js"><link rel="prefetch" href="/assets/js/14.81c7bd6e.js"><link rel="prefetch" href="/assets/js/15.c57624cb.js"><link rel="prefetch" href="/assets/js/16.6856f8a9.js"><link rel="prefetch" href="/assets/js/17.b4d47e69.js"><link rel="prefetch" href="/assets/js/18.8ce016f1.js"><link rel="prefetch" href="/assets/js/19.7a21e0c9.js"><link rel="prefetch" href="/assets/js/20.66494330.js"><link rel="prefetch" href="/assets/js/21.d60cd7df.js"><link rel="prefetch" href="/assets/js/23.dfa7231c.js"><link rel="prefetch" href="/assets/js/24.23b61158.js"><link rel="prefetch" href="/assets/js/25.87ec394f.js"><link rel="prefetch" href="/assets/js/26.9a78b7f8.js"><link rel="prefetch" href="/assets/js/27.d922f615.js"><link rel="prefetch" href="/assets/js/28.65b1a1e8.js"><link rel="prefetch" href="/assets/js/29.ad956996.js"><link rel="prefetch" href="/assets/js/3.8581f20c.js"><link rel="prefetch" href="/assets/js/30.6c3043be.js"><link rel="prefetch" href="/assets/js/31.cbb1bc22.js"><link rel="prefetch" href="/assets/js/32.78f14a65.js"><link rel="prefetch" href="/assets/js/33.fb0d84f4.js"><link rel="prefetch" href="/assets/js/34.4dbfc980.js"><link rel="prefetch" href="/assets/js/35.d18f948e.js"><link rel="prefetch" href="/assets/js/36.296a95fe.js"><link rel="prefetch" href="/assets/js/37.42201313.js"><link rel="prefetch" href="/assets/js/38.c2c30190.js"><link rel="prefetch" href="/assets/js/39.cec55229.js"><link rel="prefetch" href="/assets/js/4.0e70482a.js"><link rel="prefetch" href="/assets/js/40.7c86a0a4.js"><link rel="prefetch" href="/assets/js/41.6cd3edc9.js"><link rel="prefetch" href="/assets/js/5.b2bfcdf0.js"><link rel="prefetch" href="/assets/js/7.2741dbd3.js"><link rel="prefetch" href="/assets/js/8.948f9430.js"><link rel="prefetch" href="/assets/js/9.8e0f13bf.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1b1033a6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.jpg" alt="OrBIT Portal" class="logo"> <span class="site-name can-hide">OrBIT Portal</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/information/" class="nav-link">
  おしらせ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ユーザーガイド" class="dropdown-title"><span class="title">ユーザーガイド</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/common/introduction.html" class="nav-link">
  はじめに
</a></li><li class="dropdown-item"><!----> <a href="/guide/aws/" class="nav-link router-link-active">
  AWSを利用する場合
</a></li><li class="dropdown-item"><!----> <a href="/guide/gcp/" class="nav-link">
  GCPを利用する場合
</a></li><li class="dropdown-item"><!----> <a href="/guide/common/glossary.html" class="nav-link">
  用語集
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="各種申請" class="dropdown-title"><span class="title">各種申請</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          クラウド環境関連
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/request/create-env.html" class="nav-link">
  払い出し申請
</a></li><li class="dropdown-subitem"><a href="/request/update-env.html" class="nav-link">
  設定変更申請
</a></li><li class="dropdown-subitem"><a href="/request/destroy-env.html" class="nav-link">
  解約申請
</a></li></ul></li><li class="dropdown-item"><h4>
          ユーザー関連
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/request/regist-user.html" class="nav-link">
  登録申請
</a></li><li class="dropdown-subitem"><a href="/request/update-user.html" class="nav-link">
  情報変更申請
</a></li><li class="dropdown-subitem"><a href="/request/unregist-user.html" class="nav-link">
  削除申請
</a></li></ul></li><li class="dropdown-item"><h4>
          作業依頼
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/request/update-support.html" class="nav-link">
  サポートプラン変更
</a></li><li class="dropdown-subitem"><a href="/request/analyze-auditlog.html" class="nav-link">
  監査ログ確認
</a></li><li class="dropdown-subitem"><a href="/request/other.html" class="nav-link">
  その他
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="カタログ" class="dropdown-title"><span class="title">カタログ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/catalog/introduction.html" class="nav-link">
  カタログとは
</a></li><li class="dropdown-item"><!----> <a href="/catalog/list.html" class="nav-link">
  カタログ一覧
</a></li><li class="dropdown-item"><!----> <a href="/catalog/feedback.html" class="nav-link">
  要望/フィードバック
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="サポート" class="dropdown-title"><span class="title">サポート</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/support/release.html" class="nav-link">
  リリースノート
</a></li><li class="dropdown-item"><!----> <a href="/support/contact.html" class="nav-link">
  お問い合わせ
</a></li></ul></div></div> <a href="https://github.com/jkc-cloud/orbit-doc-UserManual" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/information/" class="nav-link">
  おしらせ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ユーザーガイド" class="dropdown-title"><span class="title">ユーザーガイド</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/common/introduction.html" class="nav-link">
  はじめに
</a></li><li class="dropdown-item"><!----> <a href="/guide/aws/" class="nav-link router-link-active">
  AWSを利用する場合
</a></li><li class="dropdown-item"><!----> <a href="/guide/gcp/" class="nav-link">
  GCPを利用する場合
</a></li><li class="dropdown-item"><!----> <a href="/guide/common/glossary.html" class="nav-link">
  用語集
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="各種申請" class="dropdown-title"><span class="title">各種申請</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          クラウド環境関連
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/request/create-env.html" class="nav-link">
  払い出し申請
</a></li><li class="dropdown-subitem"><a href="/request/update-env.html" class="nav-link">
  設定変更申請
</a></li><li class="dropdown-subitem"><a href="/request/destroy-env.html" class="nav-link">
  解約申請
</a></li></ul></li><li class="dropdown-item"><h4>
          ユーザー関連
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/request/regist-user.html" class="nav-link">
  登録申請
</a></li><li class="dropdown-subitem"><a href="/request/update-user.html" class="nav-link">
  情報変更申請
</a></li><li class="dropdown-subitem"><a href="/request/unregist-user.html" class="nav-link">
  削除申請
</a></li></ul></li><li class="dropdown-item"><h4>
          作業依頼
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/request/update-support.html" class="nav-link">
  サポートプラン変更
</a></li><li class="dropdown-subitem"><a href="/request/analyze-auditlog.html" class="nav-link">
  監査ログ確認
</a></li><li class="dropdown-subitem"><a href="/request/other.html" class="nav-link">
  その他
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="カタログ" class="dropdown-title"><span class="title">カタログ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/catalog/introduction.html" class="nav-link">
  カタログとは
</a></li><li class="dropdown-item"><!----> <a href="/catalog/list.html" class="nav-link">
  カタログ一覧
</a></li><li class="dropdown-item"><!----> <a href="/catalog/feedback.html" class="nav-link">
  要望/フィードバック
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="サポート" class="dropdown-title"><span class="title">サポート</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/support/release.html" class="nav-link">
  リリースノート
</a></li><li class="dropdown-item"><!----> <a href="/support/contact.html" class="nav-link">
  お問い合わせ
</a></li></ul></div></div> <a href="https://github.com/jkc-cloud/orbit-doc-UserManual" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>ユーザーガイド(AWS)</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/aws/" class="sidebar-link">利用開始にあたって</a></li><li><a href="/guide/aws/account-management.html" class="sidebar-link">AWSアカウントの管理</a></li><li><a href="/guide/aws/billing.html" class="sidebar-link">利用料金の支払い</a></li><li><a href="/guide/aws/id-management.html" class="sidebar-link">ユーザーIDの管理</a></li><li><a href="/guide/aws/security.html" class="sidebar-link">セキュリティ</a></li><li><a href="/guide/aws/threat-detection.html" class="sidebar-link">脅威検知</a></li><li><a href="/guide/aws/monitoring.html" class="active sidebar-link">監視とエスカレーション</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/aws/monitoring.html#利用するawsサービス" class="sidebar-link">利用するAWSサービス</a></li><li class="sidebar-sub-header"><a href="/guide/aws/monitoring.html#監視対象" class="sidebar-link">監視対象</a></li><li class="sidebar-sub-header"><a href="/guide/aws/monitoring.html#アーキテクチャ" class="sidebar-link">アーキテクチャ</a></li><li class="sidebar-sub-header"><a href="/guide/aws/monitoring.html#監視設定" class="sidebar-link">監視設定</a></li><li class="sidebar-sub-header"><a href="/guide/aws/monitoring.html#セキュリティエスカレーション" class="sidebar-link">セキュリティエスカレーション</a></li><li class="sidebar-sub-header"><a href="/guide/aws/monitoring.html#チュートリアル" class="sidebar-link">チュートリアル</a></li></ul></li><li><a href="/guide/aws/audit.html" class="sidebar-link">監査ログの記録と収集</a></li><li><a href="/guide/aws/baseline.html" class="sidebar-link">ベースライン</a></li><li><a href="/guide/aws/faq.html" class="sidebar-link">よくある質問</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="監視とエスカレーション"><a href="#監視とエスカレーション" class="header-anchor">#</a> 監視とエスカレーション</h1> <p>クラウドを利用するにあたって、<a href="/guide/aws/security">セキュリティ</a>は非常に重要であり、また、<a href="/guide/aws/threat-detection">脅威検知</a>といったセキュリティインシデントを把握可能な仕組み作りや体制の構築が非常に重要になります。</p> <p>OrBITではセキュリティポリシーを定義するだけでなく、セキュリティインシデントが発生した際に、通知を受け取る事ができる仕組みを提供します。また、重大なインシデントに関しては、OrBIT運用チームが直接、プロジェクトへエスカレーションするサービスを提供します。</p> <p></p><div class="table-of-contents"><ul><li><a href="#利用するawsサービス">利用するAWSサービス</a></li><li><a href="#監視対象">監視対象</a></li><li><a href="#アーキテクチャ">アーキテクチャ</a></li><li><a href="#監視設定">監視設定</a></li><li><a href="#セキュリティエスカレーション">セキュリティエスカレーション</a><ul><li><a href="#エスカレーションフロー">エスカレーションフロー</a></li><li><a href="#エスカレーションの可否判断">エスカレーションの可否判断</a></li></ul></li><li><a href="#チュートリアル">チュートリアル</a><ul><li><a href="#aws-chatbotを利用してslackへ通知する">AWS Chatbotを利用してSlackへ通知する</a></li></ul></li></ul></div><p></p> <h2 id="利用するawsサービス"><a href="#利用するawsサービス" class="header-anchor">#</a> 利用するAWSサービス</h2> <p>OrBITでは、セキュリティの監視に以下のサービスを利用します。</p> <ul><li><p><em><strong>Amazon Simple Notification Service (Amzaon SNS)</strong></em></p> <p>サブスクライブしているクライアントへのメッセージの配信、管理を行うサービスです。<br>
Eメールをはじめとした、様々なプロトコルでサブスクライブすることが可能であり、検知した内容を本サービスを通じて通知することにより、監視を実現します。</p> <p>詳細は以下を参照してください。</p> <ul><li><a href="https://docs.aws.amazon.com/ja_jp/sns/latest/dg/welcome.html" target="_blank" rel="noopener noreferrer">「Amazon SNSユーザーガイド」<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://aws.amazon.com/jp/sns/pricing/" target="_blank" rel="noopener noreferrer">「Amazon SNS料金」<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li><p><em><strong>AWS Chatbot</strong></em></p> <p>SlackチャンネルやAmazon Chimeチャットルームで、AWSのリソースを簡単にモニタリングできるようにしてくれるサービスです。<br> <em>AWS Chatbot</em>を使用すると、簡単にSlackと連携が可能で、文面の自動整形機能も備えているため、整えた上で監視設定のコストを抑える事ができます。</p> <p>詳細は以下を参照してください。</p> <ul><li><a href="https://docs.aws.amazon.com/ja_jp/chatbot/latest/adminguide/what-is.html" target="_blank" rel="noopener noreferrer">「AWS Chatbotユーザーガイド」<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <div class="custom-block tip"><p class="custom-block-title">INFO</p> <p><em>AWS Chatbot</em>の利用に料金はかかりません。</p></div></li></ul> <h2 id="監視対象"><a href="#監視対象" class="header-anchor">#</a> 監視対象</h2> <p>OrBITでは、以下の3つのAWSサービスから取得できる情報を監視対象とします。</p> <ul><li><p><em>Amazon GuardDuty</em>の検知結果</p> <p><em>Amazon GuardDuty</em>では、悪意のある操作や不正な動作を検知可能であり、その結果について監視する事ができます。詳細については、<a href="/guide/aws/threat-detection">「脅威検知」</a>を参照してください。</p></li> <li><p><em>AWS CloudTrail</em>における特定のイベント</p> <p><em>AWS CloudTrail</em>では、すべての操作履歴を記録しており、インシデントが発生する可能性のある操作を検知することで、未然に防ぐことができます。詳細については、<a href="/guide/aws/baseline#%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E3%83%9D%E3%83%AA%E3%82%B7%E3%83%BC%E9%80%B8%E8%84%B1%E6%A4%9C%E5%87%BA%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF">「セキュリティポリシー逸脱検出スタック」</a>を参照してください。</p></li> <li><p><em>AWS Config Rules</em>の評価結果</p> <p><em>AWS Config Rules</em>では、セキュリティポリシーに対する準拠状態を評価することができ、迅速に逸脱を検知することができます。詳細については、<a href="/guide/aws/baseline#%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E3%83%9D%E3%83%AA%E3%82%B7%E3%83%BC%E6%BA%96%E6%8B%A0%E7%8A%B6%E6%85%8B%E7%A2%BA%E8%AA%8D%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF">「セキュリティポリシー準拠状態確認スタック」</a>を参照してください。</p></li></ul> <h2 id="アーキテクチャ"><a href="#アーキテクチャ" class="header-anchor">#</a> アーキテクチャ</h2> <p>監視対象から通知を受け取る仕組みは、<a href="/guide/aws/baseline#%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3">「ベースラインのアーキテクチャ」</a>を参照してください。</p> <h2 id="監視設定"><a href="#監視設定" class="header-anchor">#</a> 監視設定</h2> <p>プロジェクトで通知を受け取るには、受信したい情報に該当するSNSトピックをサブスクライブする必要があります。任意のサブスクライバを利用することが可能ですので、プロジェクト側の運用に適したプロトコルでサブスクライブしてください。</p> <p>以下のチュートリアルでは、監視設定の一例を紹介していますので参考にしてください。</p> <ul><li><a href="#aws-chatbot%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%A6slack%E3%81%B8%E9%80%9A%E7%9F%A5%E3%81%99%E3%82%8B">「AWS Chatbotを利用してSlackへ通知する」</a></li></ul> <h2 id="セキュリティエスカレーション"><a href="#セキュリティエスカレーション" class="header-anchor">#</a> セキュリティエスカレーション</h2> <p>OrBITでは、緊急度の高いインシデントが発生した際、プロジェクトへエスカレーションするサービスを提供しています。</p> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>もし、運用を外部へ委託する場合など、エスカレーションが不要な場合はご連絡ください。</p></div> <h3 id="エスカレーションフロー"><a href="#エスカレーションフロー" class="header-anchor">#</a> エスカレーションフロー</h3> <hr> <p>インシデントの発生から解消までのエスカレーションフローを以下に示します。<br>
また、エスカレーションフローにおけるプロジェクト側での調査や判断の手順についても説明します。<br> <figure><img src="/img/escalation.png" alt> <div style="text-align:right"><figcaption><i>セキュリティエスカレーションのフロー</i></figcaption></div></figure></p> <h4 id="_1-アラート受信"><a href="#_1-アラート受信" class="header-anchor">#</a> 1. アラート受信</h4> <p>インシデントが発生すると、プロジェクトアカウントの<em>Amazon SNS</em>トピックに検知した内容が発行され、サブスクライバへと通知されます。</p> <div class="custom-block warning"><p class="custom-block-title">ATTENTION</p> <p>プロジェクト側でアラートを受信する場合は、事前に該当するSNSトピックのサブスクライブが必要です。</p></div> <div class="custom-block tip"><p class="custom-block-title">INFO</p> <p>同様の内容の通知を<strong>OrBIT運用チーム</strong>でも受け取っています。</p></div> <h4 id="_2-要因の調査"><a href="#_2-要因の調査" class="header-anchor">#</a> 2. 要因の調査</h4> <p>アラートの受信後は、発生した要因を調査します。<br>
要因の調査は発生元によって異なりますので、該当する監視対象の調査手順をを参考にしながら調査を行ってください。</p> <ul><li><em>Amazon GuardDuty</em>からの通知の場合は、<a href="/guide/aws/threat-detection#%E8%84%85%E5%A8%81%E5%86%85%E5%AE%B9%E3%81%AE%E7%A2%BA%E8%AA%8D">「脅威内容の確認」</a>を参考にしてください。</li> <li><em>AWS CloudTrail</em>からの通知の場合は、<a href="/guide/aws/audit#%E6%93%8D%E4%BD%9C%E3%83%AD%E3%82%B0%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%81%A8%E8%A7%A3%E6%9E%90">「操作ログの確認と解析」</a>を参考にしてください。</li> <li><em>AWS Config Rule</em>からの通知の場合は、<a href="/guide/aws/audit#%E6%A7%8B%E6%88%90%E5%A4%89%E6%9B%B4%E3%83%AD%E3%82%B0%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%81%A8%E8%A7%A3%E6%9E%90">「 構成変更ログの確認と解析」</a>を参考にしてください。</li></ul> <p><strong>OrBIT運用チーム</strong>では、AWSアカウントの利用目的、およびアラート種別を考慮した上で、プロジェクトへ連絡するか否かを決定します。その判断基準については、<a href="#%E3%82%A8%E3%82%B9%E3%82%AB%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E5%8F%AF%E5%90%A6%E5%88%A4%E6%96%AD">「エスカレーションの可否判断」</a>をご覧ください。</p> <p>連絡が必要と判断した場合は、以下の方へEメールにて連絡を行います。</p> <ul><li><strong>「プロジェクト責任者」</strong> の役割を割り当てられた方</li> <li><strong>「セキュリティ担当者」</strong> の役割を割り当てられた方</li></ul> <div class="custom-block warning"><p class="custom-block-title">ATTENTION</p> <p>プロジェクト側でアラートの受信設定をしている場合、同様のアラート内容に関して要因の調査依頼をお願いする場合があります。</p></div> <h4 id="_3-要因が判明したか否か"><a href="#_3-要因が判明したか否か" class="header-anchor">#</a> 3. 要因が判明したか否か</h4> <p>要因の調査を行った結果、その要因が判明しなかった場合、<strong>OrBIT運用チーム</strong>にご連絡ください。<br>
調査の支援をさせて頂きます。</p> <h4 id="_4-意図した操作か否か"><a href="#_4-意図した操作か否か" class="header-anchor">#</a> 4. 意図した操作か否か</h4> <p>要因が判明した場合、その要因が意図した操作であるかを確認します。<br>
もし、意図した操作である場合は問題が無いと判断し、インシデントは解消されたものとします。<br>
意図した操作でない場合は、対象のリソースが攻撃対象となっている可能性がありますので、その要因を取り除くための対策をする必要があります。</p> <h4 id="_5-対応可能か否か"><a href="#_5-対応可能か否か" class="header-anchor">#</a> 5. 対応可能か否か</h4> <p>攻撃を受けている可能性がある以上、要因を取り除くため、迅速に対策を打つ必要があります。<br>
要因の発生元に応じて、対策方法を検討してください。</p> <ul><li><em>Amazon GuardDuty</em>からの通知の場合は、<a href="/guide/aws/threat-detection#%E8%84%85%E5%A8%81%E3%81%B8%E3%81%AE%E5%AF%BE%E7%AD%96">「脅威への対策」</a>を参考にしてください。</li> <li><em>AWS CloudTrail</em>からの通知の場合は、<a href="/guide/aws/audit#%E6%93%8D%E4%BD%9C%E3%83%AD%E3%82%B0%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%81%A8%E8%A7%A3%E6%9E%90">「操作ログの確認と解析」</a>を参考にしてください。</li> <li><em>AWS Config Rules</em>からの通知の場合は、<a href="/guide/aws/audit#%E6%A7%8B%E6%88%90%E5%A4%89%E6%9B%B4%E3%83%AD%E3%82%B0%E3%81%AE%E7%A2%BA%E8%AA%8D%E3%81%A8%E8%A7%A3%E6%9E%90">「構成変更ログの確認と解析」</a>を参考にしてください。</li></ul> <p>もし、「対策手段が分からない」という場合は<strong>OrBIT運用チーム</strong>にご連絡ください。<br>
対応方法に関して支援をさせて頂きます。</p> <h4 id="_6-リソースの修正"><a href="#_6-リソースの修正" class="header-anchor">#</a> 6. リソースの修正</h4> <p>対応方法の内容、日時、リスク、手順などが決定したら、対象となるリソースの修正を行います。</p> <div class="custom-block danger"><p class="custom-block-title">IMPORTANT</p> <p>OrBIT運用チームでは、<a href="/guide/common/introduction#%E8%B2%AC%E4%BB%BB%E5%85%B1%E6%9C%89%E3%83%A2%E3%83%87%E3%83%AB">責任共有モデル</a>に準じ、プロジェクト側のリソースを操作する権限を持ちませんので、インシデント対策に関する実作業はできませんのでご理解ください。</p></div> <h4 id="_7-インシデント解消"><a href="#_7-インシデント解消" class="header-anchor">#</a> 7. インシデント解消</h4> <p>対象となるリソースに対して修正作業が終わった後は、その効果を確認します。<br>
修正が適切ではない場合、しばらくした後、再度アラートが発行されますので<a href="#_1-%E3%82%A2%E3%83%A9%E3%83%BC%E3%83%88%E5%8F%97%E4%BF%A1">「1. アラート受信」</a>からやり直します。</p> <h3 id="エスカレーションの可否判断"><a href="#エスカレーションの可否判断" class="header-anchor">#</a> エスカレーションの可否判断</h3> <p>エスカレーションフローの<a href="#_2-%E8%A6%81%E5%9B%A0%E3%81%AE%E8%AA%BF%E6%9F%BB">「2. 要因の調査」</a>で記載したように、<strong>OrBIT運用チーム</strong>では、プロジェクト側に通知されるものと同様の通知を受け取っており、インシデントが発生したAWSアカウントの利用目的、およびインシデントの重大性を考慮した上で、プロジェクトへエスカレーションするかを判断します。</p> <p>各監視対象における、エスカレーションの可否は以下のマッピングに従って判断されます。</p> <blockquote><p>✔️がついている場合、エスカレーションを実施します。</p></blockquote> <ul><li><em>Amazon GuardDuty</em>の検知結果</li></ul> <table><thead><tr><th style="text-align:center;">概念実証<br>開発環境<br>ステージング環境</th> <th style="text-align:center;">本番環境</th> <th style="text-align:center;">重要度</th> <th style="text-align:left;">結果タイプ</th> <th style="text-align:left;">概要</th></tr></thead> <tbody><tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">Backdoor:EC2/Spambot</td> <td style="text-align:left;">EC2 インスタンスがポート 25 でリモートホストと通信して通常と異なる動作を示しています。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">Backdoor:EC2/C&amp;CActivity.B!DNS</td> <td style="text-align:left;">EC2 インスタンスは、既知のコマンドアンドコントロールサーバーに関連付けられるドメイン名をクエリしています。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">Backdoor:EC2/DenialOfService.Tcp</td> <td style="text-align:left;">EC2 インスタンスが、TCP プロトコルを使用したサービス拒否 (DoS) 攻撃の実行に利用されている可能性があります。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">Backdoor:EC2/DenialOfService.Udp</td> <td style="text-align:left;">EC2 インスタンスが、UDP プロトコルを使用したサービス拒否 (DoS) 攻撃の実行に利用されている可能性があります。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">Backdoor:EC2/DenialOfService.Dns</td> <td style="text-align:left;">EC2 インスタンスが、DNS プロトコルを使用したサービス拒否 (DoS) 攻撃の実行に利用されている可能性があります。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">Backdoor:EC2/DenialOfService.UdpOnTcpPorts</td> <td style="text-align:left;">C2 インスタンスが、TCP ポートで UDP プロトコルを使用したサービス拒否 (DoS) 攻撃の実行に利用されている可能性があります。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">Backdoor:EC2/DenialOfService.UnusualProtocol</td> <td style="text-align:left;">EC2 インスタンスが、異常なプロトコルを使用したサービス拒否 (DoS) 攻撃の実行に利用されている可能性があります。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">Behavior:EC2/NetworkPortUnusual</td> <td style="text-align:left;">EC2 インスタンスが通常と異なるポートでリモートホストと通信しています。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">Behavior:EC2/TrafficVolumeUnusual</td> <td style="text-align:left;">EC2 インスタンスがリモートホストに対して通常と異なる大量のネットワークトラフィックを生成しています。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">CryptoCurrency:EC2/BitcoinTool.B!DNS</td> <td style="text-align:left;">EC2 インスタンスは、暗号通貨関連のアクティビティに関連付けられているドメイン名をクエリしています。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">CryptoCurrency:EC2/BitcoinTool.B</td> <td style="text-align:left;">EC2 インスタンスは、暗号通貨関連のアクティビティに関連付けられている IP アドレスをクエリしています。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">PenTest:IAMUser/KaliLinux</td> <td style="text-align:left;">API が Kali Linux EC2 インスタンスから呼び出されました。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">PenTest:IAMUser/ParrotLinux</td> <td style="text-align:left;">API が Parrot Security Linux EC2 インスタンスから呼び出されました。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">PenTest:IAMUser/PentooLinux</td> <td style="text-align:left;">API が Pentoo Linux EC2 インスタンスから呼び出されました。</td></tr> <tr><td style="text-align:center;">✔️*1</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中(高)</td> <td style="text-align:left;">Persistence:IAMUser/NetworkPermissions</td> <td style="text-align:left;">プリンシパルが、通常 AWS アカウントのセキュリティグループ、ルート、ACL のネットワークアクセス許可を変更するために使用される API を呼び出した。</td></tr> <tr><td style="text-align:center;">✔️*1</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中(高)</td> <td style="text-align:left;">Persistence:IAMUser/ResourcePermissions</td> <td style="text-align:left;">プリンシパルが、通常 AWS アカウントのさまざまなリソースのセキュリティアクセスポリシーを変更するために使用される API を呼び出した。</td></tr> <tr><td style="text-align:center;">✔️*1</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中(高)</td> <td style="text-align:left;">Persistence:IAMUser/UserPermissions</td> <td style="text-align:left;">プリンシパルが、通常 AWS アカウントの IAM ユーザー、グループ、ポリシーを追加、変更、削除するために使用される API を呼び出した。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">低</td> <td style="text-align:left;">Policy:IAMUser/S3BlockPublicAccessDisabled</td> <td style="text-align:left;">バケットの Amazon S3 ブロックパブリックアクセスが無効になりました</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">低</td> <td style="text-align:left;">Policy:IAMUser/RootCredentialUsage</td> <td style="text-align:left;">API がルート認証情報を使用して呼び出された。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">低(中)</td> <td style="text-align:left;">PrivilegeEscalation:IAMUser/AdministrativePermissions</td> <td style="text-align:left;">プリンシパルが許容度の高いポリシーを割り当てようとしています。この動作は特権エスカレーション攻撃に関連付けられます。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">低</td> <td style="text-align:left;">Recon:EC2/PortProbeUnprotectedPort</td> <td style="text-align:left;">EC2 インスタンスの保護されていないポートを既知の悪意のあるホストが探しています。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">Recon:EC2/PortProbeEMRUnprotectedPort</td> <td style="text-align:left;">EMR クラスターに、セキュリティグループ、アクセスコントロールリスト (ACL)、またはホストのファイアウォール (Linux IPChains など) でブロックされていない EMR 関連の sensitive port ポートがあり、これをインターネットの既知のスキャナーが巧みに見つけようとしていることを知らせます</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">Recon:IAMUser/TorIPCaller</td> <td style="text-align:left;">API が Tor 出口ノードの IP アドレスから呼び出されました。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">Recon:IAMUser/MaliciousIPCaller.Custom</td> <td style="text-align:left;">API がカスタム脅威リストにある IP アドレスから呼び出されました。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">Recon:IAMUser/MaliciousIPCaller</td> <td style="text-align:left;">API が既知の悪意のある IP アドレスから呼び出されました。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">Recon:EC2/Portscan</td> <td style="text-align:left;">EC2 インスタンスがリモートホストにアウトバウンドポートスキャンを実行しています。</td></tr> <tr><td style="text-align:center;">✔️*1</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中(高)</td> <td style="text-align:left;">Recon:IAMUser/NetworkPermissions</td> <td style="text-align:left;">プリンシパルが、通常 AWS アカウントの既存のセキュリティグループ、ACL、ルートのネットワークアクセス許可を検出するために使用される API を呼び出した。</td></tr> <tr><td style="text-align:center;">✔️*1</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中(高)</td> <td style="text-align:left;">Recon:IAMUser/ResourcePermissions</td> <td style="text-align:left;">プリンシパルが、通常 AWS アカウントのさまざまなリソースに関連付けられたアクセス権限を検出するために使用される API を呼び出した。</td></tr> <tr><td style="text-align:center;">✔️*1</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中(高)</td> <td style="text-align:left;">Recon:IAMUser/UserPermissions</td> <td style="text-align:left;">プリンシパルが、通常 AWS アカウントのユーザー、グループ、ポリシー、アクセス権限を検出するために使用される API を呼び出した。</td></tr> <tr><td style="text-align:center;">✔️*1</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中(高)</td> <td style="text-align:left;">ResourceConsumption:IAMUser/ComputeResources</td> <td style="text-align:left;">プリンシパルが、通常 EC2 インスタンスなどのコンピューティングリソースを起動するために使用される API を呼び出した。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">低</td> <td style="text-align:left;">Stealth:IAMUser/S3ServerAccessLoggingDisabled</td> <td style="text-align:left;">バケットの Amazon S3 サーバーアクセスログ記録が無効になりました</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">低</td> <td style="text-align:left;">Stealth:IAMUser/PasswordPolicyChange</td> <td style="text-align:left;">アカウントのパスワードポリシーが弱化されています。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">低</td> <td style="text-align:left;">Stealth:IAMUser/CloudTrailLoggingDisabled</td> <td style="text-align:left;">AWS CloudTrail の証跡が無効化されています。</td></tr> <tr><td style="text-align:center;">✔️*1</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中(高)</td> <td style="text-align:left;">Stealth:IAMUser/LoggingConfigurationModified</td> <td style="text-align:left;">プリンシパルが、通常 AWS アカウントの CloudTrail ログ記録の停止、既存ログの削除、その他アクティビティの痕跡を消去するために使用される API を呼び出した。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">Trojan:EC2/BlackholeTraffic</td> <td style="text-align:left;">EC2 インスタンスは、ブラックホールと呼ばれるリモートホストの IP アドレスに通信しようとしています。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">Trojan:EC2/DropPoint</td> <td style="text-align:left;">EC2 インスタンスは、マルウェアによって収集された認証情報やその他の盗難されたデータによって認識されているリモートホストの IP アドレスに通信しようとしています。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">Trojan:EC2/BlackholeTraffic!DNS</td> <td style="text-align:left;">EC2 インスタンスは、ブラックホール IP アドレスにリダイレクトされるドメイン名へのクエリを実行しています。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">Trojan:EC2/DriveBySourceTraffic!DNS</td> <td style="text-align:left;">EC2 インスタンスは、Drive By Download 攻撃の既知のソースであるリモートホストのドメイン名をクエリしています。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">Trojan:EC2/DropPoint!DNS</td> <td style="text-align:left;">EC2 インスタンスは、マルウェアによって収集された認証情報やその他の盗難されたデータによって認識されているリモートホストのドメイン名をクエリしています。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">Trojan:EC2/DGADomainRequest.B</td> <td style="text-align:left;">EC2 インスタンスで、アルゴリズムを使用して生成されたドメインがクエリされています。このようなドメインは、一般的にマルウェアによって悪用されることが多く、EC2 インスタンスが侵害されている場合があります。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">Trojan:EC2/DGADomainRequest.C!DNS</td> <td style="text-align:left;">EC2 インスタンスで、アルゴリズムを使用して生成されたドメインがクエリされています。このようなドメインは、一般的にマルウェアによって悪用されることが多く、EC2 インスタンスが侵害されている場合があります。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">Trojan:EC2/DNSDataExfiltration</td> <td style="text-align:left;">EC2 インスタンスが DNS クエリを通じてデータを密かに抽出しようとしています。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">Trojan:EC2/PhishingDomainRequest!DNS</td> <td style="text-align:left;">EC2 インスタンスはフィッシング攻撃に関与するクエリ実行のドメインです。EC2 インスタンスは侵害されている可能性があります。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">UnauthorizedAccess:EC2/MetadataDNSRebind</td> <td style="text-align:left;">Amazon EC2 インスタンスが、インスタンスメタデータサービスに解決される DNS ルックアップを実行しています。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">UnauthorizedAccess:IAMUser/TorIPCaller</td> <td style="text-align:left;">API が Tor 出口ノードの IP アドレスから呼び出されました。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">UnauthorizedAccess:IAMUser/MaliciousIPCaller.Custom</td> <td style="text-align:left;">API がカスタム脅威リストにある IP アドレスから呼び出されました。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">UnauthorizedAccess:IAMUser/ConsoleLoginSuccess.B</td> <td style="text-align:left;">世界中でコンソールに対する複数の正常なログインが確認されました。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">UnauthorizedAccess:IAMUser/MaliciousIPCaller</td> <td style="text-align:left;">API が既知の悪意のある IP アドレスから呼び出されました。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">UnauthorizedAccess:EC2/TorIPCaller</td> <td style="text-align:left;">EC2 インスタンスが Tor 出口ノードからのインバウンド接続を受信しています。</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中</td> <td style="text-align:left;">UnauthorizedAccess:EC2/MaliciousIPCaller.Custom</td> <td style="text-align:left;">EC2 インスタンスがカスタム脅威リスト内の IP アドレスとアウトバウンド通信しています。</td></tr> <tr><td style="text-align:center;">✔️*1</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">低(高)</td> <td style="text-align:left;">UnauthorizedAccess:EC2/SSHBruteForce</td> <td style="text-align:left;">EC2 インスタンスが SSH ブルートフォース攻撃に関与しています。</td></tr> <tr><td style="text-align:center;">✔️*1</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">低(高)</td> <td style="text-align:left;">UnauthorizedAccess:EC2/RDPBruteForce</td> <td style="text-align:left;">EC2 インスタンスが RDP ブルートフォース攻撃に関与しています。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration</td> <td style="text-align:left;">インスタンス起動ロールを通じて EC2 インスタンス専用に作成された認証情報が外部 IP アドレスから使用されています。</td></tr> <tr><td style="text-align:center;">✔️*1</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">中(高)</td> <td style="text-align:left;">UnauthorizedAccess:IAMUser/ConsoleLogin</td> <td style="text-align:left;">AWS アカウントのプリンシパルによる通常とは違うコンソールへのログインが確認された。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">UnauthorizedAccess:EC2/TorClient</td> <td style="text-align:left;">EC2 インスタンスは Tor Guard または Authority ノードに接続しています。</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">高</td> <td style="text-align:left;">UnauthorizedAccess:EC2/TorRelay</td> <td style="text-align:left;">EC2 インスタンスは、Tor リレーとして Tor ネットワークに接続中です。</td></tr></tbody></table> <p>*1 この結果タイプは、場合によっては優先度が<strong>高</strong>となり、その場合のみエスカレーションされます。</p> <ul><li><em>AWS CloudTrail</em>のイベントログ</li></ul> <table><thead><tr><th style="text-align:center;">概念実証<br>開発環境<br>ステージング環境</th> <th style="text-align:center;">本番環境</th> <th style="text-align:left;">アラート名</th> <th style="text-align:left;">操作内容</th></tr></thead> <tbody><tr><td style="text-align:center;"></td> <td style="text-align:center;"></td> <td style="text-align:left;">orbit-CloudTrailAuthorizationFailures</td> <td style="text-align:left;">許可されていないAPI呼び出し</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-CloudTrailRouteTableChanges</td> <td style="text-align:left;">ルートテーブルの変更</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-CloudTrailS3BucketPolicyChanges</td> <td style="text-align:left;">S3バケットポリシー変更</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-CloudTrailIAMPolicyChanges</td> <td style="text-align:left;">IAMポリシー変更</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-CloudTrailSecurityGroupChanges</td> <td style="text-align:left;">セキュリティグループ変更</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-CloudTrailGatewayChanges</td> <td style="text-align:left;">Customer Gatewayまたは Internet Gateway 変更</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-CloudTrailConsoleSignInWithoutMFA</td> <td style="text-align:left;">MFAなしのコンソールログイン</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-CloudTrailCMKsDisabled</td> <td style="text-align:left;">CMK無効化</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-CloudTrailNetworkAclChanges</td> <td style="text-align:left;">ネットワークACL変更</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-CloudTrailConfigChanges</td> <td style="text-align:left;">Config変更</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-CloudTrailVpcChanges</td> <td style="text-align:left;">VPC変更</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-CloudTrailChanges</td> <td style="text-align:left;">CloudTrail変更</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-CloudTrailConsoleSignInFailures</td> <td style="text-align:left;">ログイン失敗3回以上</td></tr> <tr><td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-CloudTrailRootAccountUsed</td> <td style="text-align:left;">ルートアカウント使用</td></tr></tbody></table> <ul><li><em>AWS Config Rules</em>の評価結果</li></ul> <table><thead><tr><th style="text-align:center;">概念実証<br>開発環境<br>ステージング環境</th> <th style="text-align:center;">本番環境</th> <th style="text-align:left;">ルール名</th> <th style="text-align:left;">評価条件</th></tr></thead> <tbody><tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-DisallowSpecifiedPort</td> <td style="text-align:left;">ポート&quot;22&quot;または&quot;3389&quot;に対するSSHトラフィックが制限されていない</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-VpcDefaultSecurityGroupClosed</td> <td style="text-align:left;">デフォルトセキュリティグループに1つ以上のインバウンドまたはアウトバウンドトラフィックがある</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-VpcFlowLogsEnabled</td> <td style="text-align:left;">VPCフローログがVPCに対して無効</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-AccessKeyRotated</td> <td style="text-align:left;">アクセスキーが90日を超えてローテートされていない</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">✔️</td> <td style="text-align:left;">orbit-CMKBackingKeyRotationEnabled</td> <td style="text-align:left;">カスタマーマスターキーのローテーションが無効</td></tr></tbody></table> <h2 id="チュートリアル"><a href="#チュートリアル" class="header-anchor">#</a> チュートリアル</h2> <h3 id="aws-chatbotを利用してslackへ通知する"><a href="#aws-chatbotを利用してslackへ通知する" class="header-anchor">#</a> AWS Chatbotを利用してSlackへ通知する</h3> <p>このチュートリアルについては、以下のサイトを参照してください。</p> <ul><li><a href="https://www.simpline.co.jp/tech/aws%E3%81%AE%E3%82%A2%E3%83%A9%E3%83%BC%E3%83%A0%E3%82%92aws-chatbot%E3%81%A7slack%E3%81%AB%E9%80%9A%E7%9F%A5%E3%81%99%E3%82%8B/" target="_blank" rel="noopener noreferrer">「AWSのアラームをAWS ChatbotでSlackに通知する」<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <div class="custom-block warning"><p class="custom-block-title">ATTENTION</p> <p>この作業は、監視したいリージョン毎に行う必要があります。作業工数を短縮するには、<em>CloudFormation</em>を利用する手段があります。詳細は以下を参照して下さい。</p> <ul><li><a href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-chatbot-slackchannelconfiguration.html" target="_blank" rel="noopener noreferrer">「CloudFormation AWS Chatbotリソースリファレンス」<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/aws/threat-detection.html" class="prev">
        脅威検知
      </a></span> <span class="next"><a href="/guide/aws/audit.html">
        監査ログの記録と収集
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.007b4e4b.js" defer></script><script src="/assets/js/2.6effe7eb.js" defer></script><script src="/assets/js/22.a6fb60dc.js" defer></script><script src="/assets/js/6.db5e8172.js" defer></script>
  </body>
</html>
