---
sidebar: auto
---

# はじめに
ナレッジとは、私たちが支援してきた様々な案件や、DevSecOpsを実践して得られた知見をまとめたものです。
単にノウハウとして記したドキュメント以外にも、作成したツールや特定の機能を実現するためのアーキテクチャなどを紹介しています。

クラウドを利用した開発や運用を行う際には参考になると思いますので、是非ご活用ください。

## 利用に関する注意
ナレッジには、ノウハウ以外にもソースコードやテンプレートとして紹介しているものがあり、そのままご利用いただくことが可能です。

ご利用の際には、使い方や実装に関するサポート対応が可能ですが、実際にサービスへ組み込んで利用する場合は、その運用および責任については利用者側となることに注意してください。

詳細については、[「利用規約」](/support/agreement.html)をご確認ください。

## DevSecOpsについて
DevSecOpsとは、開発チーム(Dev)と運用チーム(Ops)がシームレスに連携することにより、迅速なリリースを実現するDevOpsにセキュリティチーム(Sec)を含めることで、プロセス全体にセキュリティ対策を組み込んだものです。

ソフトウェア開発ライフサイクルの早期からセキュリティ対策を行うことにより、DevOpsが持つアジリティを損なうことなく、安全で品質の高いソフトウェアの開発を実現します。

DevSecOpsのプロセスは度々、以下のような図で表現されます。
![](/img/dev-sec-ops.jpg)

プロセスは、いくつかの段階(本書ではフェーズと呼びます)を進みながら、何度も繰り返されます。
ここでは、各フェーズの簡単な説明に加え、それぞれのフェーズにはどのようなナレッジがあるのかを紹介しています。

すべてのナレッジは、[こちら](/knowledge/search.html)から見つけることができますので、合わせてご利用ください。

### 「PLAN」フェーズ
---
このフェーズでは、開発するシステムやアプリケーションに求められる要件、タスク、進捗管理の方法などを定義し、実行計画を決定します。
また、脅威モデリングを実施し、守るべき資産や直面する可能性のあるすべての脅威を明らかにし、リスクを把握することも重要です。

- **よく使われるツール**

  - **プロジェクト管理ツール (Redmine / Backlogなど)**
    プロジェクトを管理するために必要な、課題管理・ガントチャート・Wikiなどの様々な機能を備えたWebベースのソフトウェアです。
    SaaSとして利用できるツールも多く、運用の負担を軽減することができるので、積極的な利用を推奨します。

  - **ファイル管理ツール (Google Drive / Microsoft SharePointなど)**
    プロジェクトに関連するドキュメントやコンテンツを格納し、管理するためのツールです。
    単純なストレージとしてだけではなく、ナレッジベースやコラボレーション活動を行うための機能も充実しています。

::: tip 関連ナレッジ
  - **「Lychee Redmineを利用した効率的なタスク管理手法」(予定)**
:::

### 「CODE」フェーズ
---
このフェーズでは、定義した要件を実現するためのソフトウェアを開発します。

低コストでパフォーマンスに優れたアーキテクチャの設計を行い、共通化された開発環境・効率良くコーディングするためのIDE・バージョン管理ツールなどを利用して実装を進めます。
また、ソースコードの品質を高めるためには、コードレビューや静的コード解析の実施も重要です。

- **よく使われるツール**

  - **バージョン管理ツール (GitHub / GitLab / BitBucketなど)**
    ソースコードもしくは関連リソースのバージョンを管理するツールです。
    単にバージョン管理をするだけはなく、コードレビューを円滑に行う機能やマージ機能などを備えており、安全で効率的な開発を行うことができます。

  - **統合開発環境 (Visual Studio Code / Eclipseなど)**
    プログラミングに必要となるテキストエディタ、コンパイル、デバッガなどが1つにまとまった開発環境です。
    中でも、Microsoft社が開発している**Visual Studio Code**は多くのプラグインが提供されており、Webアプリ開発にはおすすめです。

  - **静的解析ツール (Klocwork / Coverityなど)**
    ソースコードを解析し、コード上に存在するさまざまな誤りや脆弱性を、プログラムを実行せずに発見するツールです。
    コーディングのルールチェックや、制御フローの解析、コードの複雑度の分析なども行うことができます。

::: tip 関連ナレッジ
  - <KnowledgeLink id="DevContainer"/>
  - <KnowledgeLink id="UserManagement"/>
:::

### 「BUILD」フェーズ
---
このフェーズでは、開発したソースコードを元に、実行可能なファイルや配布するためのパッケージを作成します。
これらを作成する一連の工程はスクリプトやツールを用いて自動化することが重要で、人為的な作業ミスの抑制や工数の削減など多くのメリットがあります。

- **よく使われるツール**

  - **仮想化ツール (Dockerなど)**
    ソフトウェアの実行環境を仮想化し、記述された手続きに基づいて実行環境を構成します。
    軽量で使い捨ての環境がすぐに準備できるため、いつでも作り直して環境の再構築が可能です。
    DevSecOpsを実現するためには、**バージョン管理ツール**と並び、非常に重要なツールです。

  - **タスクランナー (Gulp / Webpack / npm-scriptsなど)**
    ビルドやローカルテストなどの開発タスクを自動化してくれるツールです。
    何度も実行するような習慣的な処理を、プログラミング言語を用いて柔軟に記述することができます。

### 「TEST」フェーズ
---
このフェーズでは、開発したソフトウェアのテストを実施し、品質やパフォーマンスを確認します。

テストには、単体テスト・結合テスト・機能テスト・負荷テスト・パフォーマンステストなどさまざまな種類が存在します。
これらのテストはDevSecOpsのプロセス上、何度も繰り返し実行されるので、自動化することが重要です。

また、利用しているライブラリやパッケージの脆弱性確認、コード内のクレデンシャル記述有無のチェック、ペネトレーションのテストなど、リリース後に大きな問題を引き起こさないためにも、セキュリティへの対策を早期に確認する必要もあります。

- **よく使われるツール**

  - **テスト自動化ツール (Selenium / JMeterなど)**
    開発したソフトウェアからバグを見つけ出すためのテストの自動化を支援するツールです。
    命令・操作・パターンなどを記述し、テストの品質ぶれを無くし、テスト工数を削減することができます。
    **Selenium**はWebアプリ、**JMeter**はWebサーバー向けですので、対象となるソフトウェアの種類に応じたツールを選択してください。

  - **脆弱性診断ツール (Burp / OWASP ZAPなど)**
    様々な侵入に用いられる攻撃手段を用いて、アプリケーションの安全性を試すためのツールです。
    手動診断に比べて診断速度が速く、コストを抑制することができます。

::: tip 関連ナレッジ
  - <KnowledgeLink id="LoadTest"/>
  - <KnowledgeLink id="ImageScan"/>
:::

### 「RELEASE」フェーズ
---
このフェーズでは、テストが完了したソフトウェアをリリースするために必要な承認作業や構成管理を行います。

DevSecOpsでは、何度も繰り返しリリースを行うため、体系的かつ明瞭な構成管理が求められます。
レビューされていないコードが含まれないように複数人で確認し、作業エビデンスを残すことが重要です。

- **よく使われるツール**

  - **バージョン管理ツール (GitHub / GitLab / BitBucketなど)**
    最近のバージョン管理ツールには、リリースを管理する機能が備わっているものが多くあります。
    コードの差分やコミットの履歴などを視覚的に確認し易く、タグ付け機能などを利用することで体系的に管理することができます。

  - **CI/CDツール (CircleCI / Jenkinsなど)**
    ソースコードのビルドやテストなど自動で実行するツールです。
    このフェーズに限らずプロセス全体で利用可能なツールで、継続的なインテグレーション(***Continuous Integration***)を実現することができます。

::: tip 関連ナレッジ
  - **「GitHubを利用した安全で効率的なワークフロー」(予定)**
:::

### 「DEPLOY」フェーズ
---
このフェーズでは、リリースしたソフトウェアをデプロイ(クラウド上で動かせる状態にすること)します。

リリースしたソフトウェアは、常にテストを合格した安全な状態で管理されていることを前提とし、マージなどのタイミングで各環境へ自動でデプロイします。
デプロイを自動化することで人為的なエラー発生のリスクを回避し、同時に作業の属人化を避けることができます。

また、デプロイしたソフトウェアがコンプライアンスに違反していないかを検証したり、脆弱性を追跡可能な状態にしておく仕組みを入れ込むなど、セキュリティ対策も重要です。

- **よく使われるツール**

  - **CI/CDツール (CircleCI / Jenkinsなど)**
    CI/CDツールは、ビルドやテストだけでなく、ソフトウェアを自動でクラウド環境へデプロイすることもでき、継続的なデリバリー(***Continuous Delivery***)を実現することができます。

  - **ホスティングサービス (AWS / GCP / Microsoft Azureなど)**
    クラウド上でアプリケーションを稼働させるために必要なコンピュートリソースを提供してくれるベンダです。
    自前でサーバーを用意する必要が無く、ある程度の運用をベンダに任せることができるため、低コストでソフトウェアを稼働させることができます。

::: tip 関連ナレッジ
  - **「AWS上へアプリケーションをデプロイするCI/CDパイプライン」(予定)**
:::

### 「OPERATE」フェーズ
---
このフェーズでは、リリースが完了したサービスを安定して運用していきます。
例えば、トラブルやインシデントが発生した際には、コミュニケーションツールなどをつかってリアルタイムに状況を共有し、迅速に解決することが求められます。

トラブルを解決する際には、インフラの構成やソースコードの変更が必要な場合があります。
場当たり的な手動対応ではなく、構成をコード化するなどして構成管理を適切に行うことが継続して安定した運用を実現するには重要です。

- **よく使われるツール**

  - **コミュニケーションツール (Slack / Teamsなど)**
    チャットベースで気軽にチームコミュニケーションを取ることができるツールです。
    チャット以外にも、Botプログラムから通知したり、他のサービスと簡単に連携することができます。

  - **構成管理(IaC)ツール (Terraform / Ansible / Chefなど)**
    インフラの構成をコードとして定義し、プロビジョニングの自動化を実現する、**IaC**(***Infrastructure as Code***)ツールです。
    コード化することにより、運用の属人化を抑え、環境の再現性を高めることができます。

::: tip 関連ナレッジ
  - **「Terraformを利用したインフラストラクチャの管理方法」(予定)**
  - **「AWS CloudFormationを利用したインフラストラクチャの管理方法」(予定)**
:::

### 「MONITOR」フェーズ
---
このフェーズでは、デプロイしたアプリケーションのパフォーマンスや、ホストするサーバーの稼働状態を監視し、メトリクスを収集します。
アクセス数、応答時間、システムリソース状況などを常に確認できるようにすることが、安定したサービスの提供へと繋がります。

また、クラウド上で動作するアプリケーションは、インターネットに面しているため、いつどのような攻撃をされるか分かりません。
ファイヤーウォールをはじめとしたリソースの保護や、不正侵入を検知する仕組み、監査ログの取得などの対策が重要です。

- **よく使われるツール**

  - **監視ツール (Zabbix / Prometheusなど)**
    アプリケーションやサーバーの監視を自動で行うことができます。
    メトリクスを一括で確認できるダッシュボードや、異常値を検出して通知する機能などを備えています。
    
::: tip 関連ナレッジ
  - **「AWS上で稼働するシステムのリソース状況やアラートをSlackへ通知する」(予定)**
:::

### 最後に
---
サービスのローンチ後は、ユーザーからのフィードバックを継続的に受け取り、次のリリースに向け、[「PLAN」フェーズ](#「plan」フェーズ)から再び開始します。
このループを繰り返すことで、迅速で安定したリリースを実現できるようになります。

<br>

## DevOpsを上手に回すための考え方 
DevSecOpsの元となるDevOpsという言葉は、2009年のオライリー主催イベント「Velocity 2009」において、Flickrのエンジニア(*John Allspaw, Paul Hammond*)により初めて公の場で用いられました。

[「10+ Deploys Per Day: Dev and Ops Cooperation at Flickr」](https://www.slideshare.net/jallspaw/10-deploys-per-day-dev-and-ops-cooperation-at-flickr)というプレゼンテーションの中で、**「開発と運用が協力することで、1日に10回以上のペースでのリリースが可能になる」** という発表とともに、DevOpsという言葉が世の中に浸透していきました。

このプレゼンテーションの中では、DevOpsを実践する上での考え方についても触れられています。
DevSecOpsのベースになるだけでなく、一般的なプロセスにも通じる考え方だと思いますので、参考までに紹介しておきます。

### ツール
---
- **Automated infrastructure**
インフラの構築を自動化する。

- **Shared version control**
ソースコードやドキュメントなどを、同じバージョン管理システムを使用し、お互いに共有する。

- **One step build and deploy**
マニュアルを作成し、手動でビルドやデプロイをするのではなく、ビルドやデプロイを自動化する。

- **Feature flags**
コード中の機能の有効や無効を設定ファイルで管理する。

- **Shared metrics**
取得したメトリクスの結果をダッシュボードでお互いに共有する。

- **IRC and IM robots**
チャットツールに自動でビルドやデプロイのログ、アラート内容を投稿する仕組みを作り、情報をお互いに共有する。

### 組織文化
---
- **Respect**
お互いに相手を尊重すること。思いやりをもって接することで、スムーズなコミュニケーションにつながる。

- **Trust**
システムに関わる全てのメンバーを信頼すること。

- **Healthy attitude about failure**
失敗に対して相手を責めず健全な態度をとること。

- **Avoiding Blame**
相手を非難しないこと。ミスはどうしても起こりうることなのでそれを非難しないようにする。

<br>
成功のためには、この考え方をしっかりとチームメンバー全員が理解し、ひとりひとりが意識を合わせて目標に向かって行動することが大切です。 
<br><br>

<Footer />
